<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>麻雀計算機</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/riot/2.6.2/riot+compiler.min.js" integrity="sha256-KbOsNM4K/TeTQehueQ3qXMtKlAHkl1c8SN109s+qpew=" crossorigin="anonymous"></script>
  </head>
  <body>
    
    <div id="hai-selected"></div>
    <div id="hai-selection"></div>
    <div id="controller"></div>

    <script type="riot/tag">
      <controller>
        <button type="button" onclick={ clear }>クリア</button>
        <button type="button" onclick={ calc }>計算</button>
        clear() {
          selectedList = [];
          mountHaiSelected();
        }
        calc() {
          alert('TODO 計算処理を追加する');
        }
      </controller>
      <hai-selected>
        <!-- 選択済みの牌一覧 -->  
        <hai each={ list } name={ x } />
        this.list = opts.list.map(x => ({x: x}));
      </hai-selected>

      <hai-selection>
        <!-- 選択する牌一覧 -->
        <div>
          <hai each={ nums } name={ x + '萬' } />
        </div>
        <div>
          <hai each={ nums } name={ x + '筒' } />
        </div>
        <div>
          <hai each={ nums } name={ x + '索' } />
        </div>
        <div>
          <hai each={ jihai } name={ x } />
        </div>
        this.nums = '一二三四五六七八九'.split('').map(x => ({x:x}));
        this.jihai = '東南西北白發中'.split('').map(x => ({x:x}));
      </hai-selection>

      <hai>
        <img src={ imgsrc } onclick={ onClick }>
        <style scoped>
          img:hover {
            opacity: .6;
          }
        </style>
        this.imgsrc = '../img/' + opts.name + '.png';
        onClick(ev) {
          addHaiSelected(opts.name);
        }
      </hai>
    </script>
    <script>
      var selectedList = [];
      var mountHaiSelected = function() {
        riot.mount('#hai-selected', 'hai-selected', { list: selectedList });
      };
      var addHaiSelected = function(name) {
        selectedList.push(name);
        mountHaiSelected();
      };
      riot.mount('#hai-selection', 'hai-selection');
      riot.mount('#controller', 'controller');
    </script>
  </body>
</html>